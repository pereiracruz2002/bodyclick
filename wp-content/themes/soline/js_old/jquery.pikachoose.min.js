(function(a){var i={autoPlay:!0,speed:5E3,text:{play:"",stop:"",previous:"Previous",next:"Next"},transition:[0],showCaption:!0,IESafe:!0};a.fn.PikaChoose=function(c){return this.each(function(){a(this).data("pikachoose",new g(this,c))})};a.PikaChoose=function(c,d){this.options=a.extend({},i,d||{});this.active=this.transition=this.thumbs=this.aniDiv=this.next=this.previous=this.textPrev=this.textNext=this.imgNext=this.imgPrev=this.imgPlay=this.imgNav=this.caption=this.anchor=this.image=this.list=null;
this.animating=!1;if("UL"==c.nodeName||"OL"==c.nodeName){this.list=a(c);this.build();this.bindEvents();for(var b=0,e=0,f=0;25>f;f++)this.aniDiv.append('<div col="'+b+'" row="'+e+'"></div>'),b++,5==b&&(e++,b=0)}};var g=a.PikaChoose;g.fn=g.prototype={pikachoose:"4.0.3"};g.fn.extend=g.extend=a.extend;g.fn.extend({build:function(){this.step=0;this.wrap=a("<div class='pika-image'></div>").insertBefore(this.list);this.image=a("<img>").appendTo(this.wrap);this.anchor=this.image.wrap("<a class='colorbox'>").parent();
this.imgNav=a("<div class='pika-imgnav'></div>").insertAfter(this.anchor);this.imgPlay=a("<a></a>").appendTo(this.imgNav);this.options.autoPlay?this.imgPlay.addClass("pause"):this.imgPlay.addClass("play");this.imgPrev=a("<a class='previous'></a>").insertAfter(this.imgPlay);this.imgNext=a("<a class='next'></a>").insertAfter(this.imgPrev);this.caption=a("<div class='caption'></div>").insertAfter(this.imgNav);this.options.showCaption||this.caption.hide();this.aniDiv=a("<div class='animation'></div>").insertAfter(this.caption);
this.textNav=a("<div class='pika-textnav'></div>").insertAfter(this.aniDiv);this.textPrev=a("<a class='previous'>"+this.options.text.previous+"</a>").appendTo(this.textNav);this.textNext=a("<a class='next'>"+this.options.text.next+"</a>").appendTo(this.textNav);this.list.addClass("pika-thumbs");this.list.children("li").wrapInner("<div class='clip' />");this.thumbs=this.list.find("img");this.active=this.thumbs.eq(0);this.finishAnimating({source:this.active.attr("ref")||this.active.attr("src"),caption:this.active.parents("li:first").find("span:first").html(),
clickThrough:this.active.parent().attr("href")||""});this.thumbs.each(this.createThumb)},createThumb:function(){var c=a(this);a(this).hide();a.data(this,"clickThrough",a(this).parent("a").attr("href")||"#");0<a(this).parent("a").length&&a(this).unwrap();a.data(this,"caption",a(this).next("span").html()||"");a(this).next("span").remove();a.data(this,"source",a(this).attr("ref")||a(this).attr("src"));a.data(this,"order",a("ul li").index(a(this).parents("li")));var d=a.data(this);a("<img />").bind("load",
{data:d},function(){var b=a(this),e=b.width(),f=b.height();0===e&&(e=b.attr("width"));0===f&&(f=b.attr("height"));var b=parseInt(c.parents(".clip").css("width").slice(0,-2))/e,h=parseInt(c.parents(".clip").css("height").slice(0,-2))/f;b<h?(b=h,h=-1*((e*b-parseInt(c.parents(".clip").css("width").slice(0,-2)))/2),h=Math.round(h),c.css({left:h})):c.css({top:0});e=Math.round(e*b);f=Math.round(f*b);c.css("position","relative");c.css({width:e+"px",height:f+"px"});c.hover(function(){a(this).stop(true,true).fadeTo(250,
1)},function(){a(this).hasClass("active")||a(this).stop(true,true).fadeTo(250,0.4)});0==d.order?(c.fadeTo(250,1),c.addClass("active")):c.fadeTo(250,0.4)}).attr("src",a(this).attr("src"))},bindEvents:function(){this.thumbs.bind("click",{self:this},this.imgClick);this.imgNext.bind("click",{self:this},this.nextClick);this.textNext.bind("click",{self:this},this.nextClick);this.imgPrev.bind("click",{self:this},this.prevClick);this.textPrev.bind("click",{self:this},this.prevClick);this.imgPlay.bind("click",
{self:this},this.playClick);this.wrap.bind("mouseenter",{self:this},function(a){a.data.self.imgPlay.stop(!0,!0).fadeIn("fast")});this.wrap.bind("mouseleave",{self:this},function(a){a.data.self.imgPlay.stop(!0,!0).fadeOut("fast")})},imgClick:function(c,d){var b=c.data.self;if(!b.animating){b.caption.fadeOut("slow");("undefined"==typeof d||"auto"!=d.how)&&b.options.autoPlay&&b.imgPlay.trigger("click");b.animating=!0;b.active.fadeTo(300,0.4).removeClass("active");b.active=a(this);b.active.addClass("active").fadeTo(200,
1);var e=a.data(this);a("<img />").bind("load",{self:b,data:e},function(){b.aniDiv.css({height:b.image.height(),width:b.image.width()}).fadeIn("fast");b.aniDiv.children("div").css({width:"20%",height:"20%","float":"left"});var c=0;-1==b.options.transition[0]?c=Math.floor(6*Math.random()):(c=b.options.transition[b.step],b.step++,b.step>=b.options.transition.length&&(b.step=0));b.options.IESafe&&a.browser.msie&&(c=0);b.doAnimation(c,e)}).attr("src",a.data(this).source)}},doAnimation:function(c,d){var b=
this,e=b.aniDiv.children("div").eq(0).width(),f=b.aniDiv.children("div").eq(0).height();b.aniDiv.children().each(function(){var b=a(this),c=Math.floor(b.parent().width()/5)*b.attr("col"),e=Math.floor(b.parent().height()/5)*b.attr("row");b.css({background:"url("+d.source+") -"+c+"px -"+e+"px",width:"0px",height:"0px",position:"absolute",top:e+"px",left:c+"px","float":"none"})});switch(c){case 0:b.aniDiv.height(b.image.height()).hide().css({background:"url("+d.source+") top left no-repeat"});b.aniDiv.children("div").hide();
b.aniDiv.fadeIn("slow",function(){b.finishAnimating(d);b.aniDiv.css({background:"transparent"})});break;case 1:b.aniDiv.children().hide().each(function(c){a(this).css({opacity:0.1}).delay(30*c).animate({opacity:1,width:e,height:f},200,"linear",function(){24==a(".animation div").index(this)&&b.finishAnimating(d)})});break;case 2:b.aniDiv.children().hide().each(function(){var c=30*a(this).attr("row");a(this).css({opacity:0.1,width:e}).delay(c).animate({opacity:1,height:f},500,"linear",function(){24==
a(".animation div").index(this)&&b.finishAnimating(d)})});break;case 3:b.aniDiv.children().hide().each(function(){var c=10*a(this).attr("col");f=b.gapper(a(this),f);a(this).css({opacity:0.1,height:f}).delay(c).animate({opacity:1,width:e},800,"linear",function(){24==a(".animation div").index(this)&&b.finishAnimating(d)})});break;case 4:b.aniDiv.children().show().each(function(c){c=10*c*Math.floor(5*Math.random());f=b.gapper(a(this),f);24==a(".animation div").index(this)&&(c=800);a(this).css({height:f,
width:e,opacity:0.01}).delay(c).animate({opacity:1},800,function(){24==a(".animation div").index(this)&&b.finishAnimating(d)})});break;case 5:b.aniDiv.height(b.image.height()).hide().css({background:"url("+d.source+") top left no-repeat"});b.aniDiv.children("div").hide();b.aniDiv.css({width:0}).animate({width:b.image.width()},"slow",function(){b.finishAnimating(d);b.aniDiv.css({background:"transparent"})});break;case 6:b.aniDiv.hide(),b.image.fadeOut("slow",function(){b.image.attr("src",d.source).fadeIn("slow",
function(){b.finishAnimating(d)})})}},finishAnimating:function(c){this.animating=!1;this.image.attr("src",c.source);this.aniDiv.hide();this.anchor.attr("href",c.clickThrough);this.options.showCaption&&this.caption.html(c.caption).fadeIn("slow");if(!0==this.options.autoPlay){var a=this;this.image.delay(this.options.speed).fadeIn(0,function(){a.options.autoPlay&&a.nextClick()})}},gapper:function(a,d){return 9==a.attr("row")&&0==a.attr("col")?ani_divs.height()-9*d:d},nextClick:function(a){var d="natural";
try{var b=a.data.self}catch(e){b=this,d="auto"}a=b.active.parents("li:first").next().find("img");0==a.length&&(a=b.list.find("img").eq(0));a.trigger("click",{how:d})},prevClick:function(a){var a=a.data.self,d=a.active.parents("li:first").prev().find("img");0==d.length&&(d=a.list.find("img:last"));d.trigger("click")},playClick:function(a){a=a.data.self;a.options.autoPlay=!a.options.autoPlay;a.imgPlay.toggleClass("play").toggleClass("pause");a.options.autoPlay&&a.nextClick()}})})(jQuery);